(function(){
	var app = angular.module('audit_soft', []);

	app.controller('map', ['$scope', '$http', function(scope, http){

		scope.indicator_type = 1;

		var load_map = function(data){
			scope.offices = data.offices;
			scope.regions = data.regions; //[{"type":"Feature","properties":{"id":"1","._REGION":" SUR ","._LOCALESCONID":" 606 ","._NEGSCONID":" 569 ","._CLIENTES":" 340 ","._MONTOCAPTCLIENTES":" 211,992,023 ","._NOCLIENTES":" 229 ","._MONTOCAPTNOCLIENTES":" 84,664,661 ","info":{"region_name":{"label":"Región","value":" SUR "},"clients_count":{"label":"Clientes","value":" 340 "}}},"geometry":{"type":"Polygon","coordinates":[[[-71.4236367814259,17.64333443076651],[-71.45237169657027,17.670179112937056],[-71.48210141120609,17.738722797934777],[-71.60553242652507,17.792344683705032],[-71.66405050656698,17.98777074753102],[-71.72548610361116,18.02535696722496],[-71.74364148451902,18.17989378678974],[-71.68026522093804,18.363444342434594],[-71.80585208494044,18.419838847646048],[-71.8661153885555,18.467853135920805],[-71.8706439680557,18.519217334283105],[-71.94137783230866,18.62004376154414],[-71.79644744338147,18.62518392854613],[-71.76375276505017,18.69755405576421],[-71.71013397776571,18.718137200310373],[-71.71244048470936,18.922563676042294],[-71.73861161777246,18.922680896076365],[-71.80516271571769,18.986766003492846],[-71.63580822947304,19.11569867173641],[-71.58734286201516,19.23081877347206],[-71.5709557699912,19.268674479119557],[-71.41167175783913,19.215285605376682],[-71.33858502112909,19.175865518779766],[-71.21835835616426,19.146988579383393],[-71.15075430838955,19.110065431132433],[-71.11891698843068,19.05957155403294],[-71.06767560294556,19.041937998345045],[-71.04832265482196,19.015774153962376],[-71.02393031301386,19.01219292698866],[-70.95837944623668,19.02773127019748],[-70.91133685708664,19.009559129877122],[-70.90538376273602,18.981553002439853],[-70.86323505749253,18.987524103470815],[-70.86119718532898,18.95650556226426],[-70.84586378670065,18.933112408723865],[-70.84902995973542,18.89492337063431],[-70.82821868694225,18.837711404165457],[-70.85067244737867,18.82437142485373],[-70.81432292847445,18.715203141509438],[-70.82907106511075,18.676568037087623],[-70.8192129049708,18.576964714402752],[-70.8509483093421,18.513295588612056],[-70.84059672717835,18.353939240560788],[-70.9426613169307,18.274328550339707],[-71.08319606171872,18.337338088859262],[-71.1274531739338,18.254310183898426],[-71.0862458372728,18.137393716201835],[-71.33298064681554,17.804552984769217],[-71.38725384526586,17.686663474449936],[-71.4236367814259,17.64333443076651]]]}},{"type":"Feature","properties":{"id":"2","._REGION":" METRO ORIENTAL ","._LOCALESCONID":" 2,002 ","._NEGSCONID":" 1,855 ","._CLIENTES":" 680 ","._MONTOCAPTCLIENTES":" 424,242,679 ","._NOCLIENTES":" 1,175 ","._MONTOCAPTNOCLIENTES":" 657,525,686 ","info":{"region_name":{"label":"Región","value":" METRO ORIENTAL "},"clients_count":{"label":"Clientes","value":" 680 "}}},"geometry":{"type":"Polygon","coordinates":[[[-69.8747953634071,18.468242595953132],[-69.87866826045826,18.47786783693158],[-69.88080924091534,18.490282787336337],[-69.87297244530848,18.494546949096403],[-69.87222980112006,18.50480344228633],[-69.89609868486531,18.521158823967735],[-69.8588836432141,18.553951784318286],[-69.79834290923215,18.56924988408807],[-69.787627609259,18.577817088541472],[-69.7656440113061,18.587925066651387],[-69.75420082550372,18.592510557001052],[-69.74789316664133,18.60684852158031],[-69.7409103895174,18.623124535939418],[-69.72018406507287,18.62948029724069],[-69.7076996702432,18.626023672398915],[-69.69084988106495,18.634383123019052],[-69.68088391217208,18.633097162968014],[-69.6448734033288,18.645615122132536],[-69.62943739706326,18.66409046857859],[-69.58090163484138,18.64801540713096],[-69.59719779336159,18.62531499871194],[-69.59535776634168,18.608672321321215],[-69.58211465444035,18.613861033861163],[-69.59308765447383,18.589732790872972],[-69.57824995786706,18.581750756858458],[-69.60740696854138,18.535787692087972],[-69.62173574348763,18.519890542848565],[-69.60746840880732,18.51102252353373],[-69.59858966548765,18.49046467480205],[-69.56675771747409,18.46987205121544],[-69.52294293143396,18.464733585791404],[-69.5319220723953,18.44062524562167],[-69.53077482491679,18.408419116941143],[-69.5454299633388,18.408616183955573],[-69.55780655304324,18.42062586018273],[-69.56993999258316,18.436785297728004],[-69.59368804279389,18.44901678086228],[-69.62355583691254,18.45050311053032],[-69.6348325169836,18.4394982382484],[-69.62870134152394,18.409117870279903],[-69.63379743549089,18.40346029201061],[-69.64616961509563,18.408227221583022],[-69.66262973577838,18.40868206087161],[-69.67168994460842,18.41753832101559],[-69.67561710776957,18.42773247093323],[-69.68151695901993,18.454736671220875],[-69.71330520290753,18.4564582273898],[-69.75465161735303,18.46916157802234],[-69.8129846542529,18.46845336038177],[-69.83467354228272,18.473311791164384],[-69.8747953634071,18.468242595953132]]]}},{"type":"Feature","properties":{"id":"3","._REGION":" METRO NORTE ","._LOCALESCONID":" 3,314 ","._NEGSCONID":" 3,065 ","._CLIENTES":" 1,011 ","._MONTOCAPTCLIENTES":" 699,537,653 ","._NOCLIENTES":" 2,054 ","._MONTOCAPTNOCLIENTES":" 1,422,543,186 ","info":{"region_name":{"label":"Región","value":" METRO NORTE "},"clients_count":{"label":"Clientes","value":" 1,011 "}}},"geometry":{"type":"Polygon","coordinates":[[[-69.94937257789772,18.526892255083364],[-69.9552178382764,18.54461685446304],[-69.97673761201473,18.55482214506744],[-69.99770557204168,18.57732279787232],[-70.0068532119378,18.608489646110517],[-70.02314223309409,18.62003193304801],[-70.029977543069,18.617232245858247],[-70.05180766806753,18.62081392757606],[-70.0672628780259,18.68281491111093],[-70.10760610011808,18.67792385511359],[-70.14953625028382,18.739092792950117],[-70.16709496972724,18.740415251612387],[-70.18136480107489,18.75668431295111],[-70.20235684040443,18.76652234573803],[-70.21800808456099,18.775855752561665],[-70.24365175651873,18.81504310286197],[-70.24104375518944,18.83955820641437],[-70.20529578542947,18.86349368270042],[-70.17839558350812,18.859964352507575],[-70.13781342199724,18.857812181880217],[-70.08265140917044,18.895480076378522],[-70.05061630877005,18.885971441878095],[-70.03464044757004,18.89020559154726],[-70.03281578264152,18.904734844736673],[-70.01739340877927,18.90750987502959],[-69.98979126232955,18.885439377017942],[-69.97484160391922,18.88425340511918],[-69.94651058421469,18.905139389468392],[-69.92229320531794,18.972890944352123],[-69.92378578987837,18.981946619412287],[-69.93361989298396,18.994951808276994],[-69.92802163251349,19.010726306840027],[-69.90948156136338,19.040169221430645],[-69.88637885750055,19.040801808287377],[-69.86568149744349,19.04517135635984],[-69.87208736872154,19.063866253864283],[-69.87024797227963,19.084770273263107],[-69.8194445160888,19.08072270937522],[-69.79931829710561,19.076582878233683],[-69.78630317500581,19.0917438929791],[-69.75015894799489,19.09355067168081],[-69.72084983757412,19.084028753624523],[-69.7034826583939,19.060098217180833],[-69.70098889073071,19.043041537105804],[-69.6648871154439,19.01134576843597],[-69.62826903513971,18.98736639409703],[-69.58651679157161,18.988064316476912],[-69.51312349120683,18.934828264059828],[-69.43386954391262,18.880498984044007],[-69.36958020914433,18.887401656695204],[-69.37726961281317,18.875834908975023],[-69.46067847554879,18.82614439762766],[-69.48597279520685,18.802594824023316],[-69.53828207797068,18.74453509409227],[-69.54998402889122,18.69121305946016],[-69.56403529893942,18.662112057737474],[-69.59125090490915,18.654503734077064],[-69.6296317756112,18.667638213094552],[-69.64667030932432,18.648952635718356],[-69.68063851444177,18.636154380315432],[-69.69244827006506,18.637434912344492],[-69.70671367773733,18.627891860193664],[-69.72134213920104,18.631985298719677],[-69.7527290295405,18.618443545032346],[-69.76535977806473,18.596880512648347],[-69.78274538237535,18.58588168274845],[-69.79217490771937,18.583061620149635],[-69.79952786684042,18.57113929721795],[-69.85659558026305,18.558554217474878],[-69.89658706820481,18.52295175073567],[-69.8963082369068,18.516162830179255],[-69.87674416052155,18.504913406288665],[-69.87599133381896,18.496757583943285],[-69.88391871166762,18.491999057428856],[-69.88351830079027,18.47860046708982],[-69.87841446208898,18.469082281852554],[-69.8860812434123,18.470260246713966],[-69.89108154118733,18.467247793536853],[-69.89159381131552,18.47370196320479],[-69.90096530036094,18.48257564406835],[-69.91481320531248,18.483770812949057],[-69.91464989640215,18.51053271541958],[-69.94937257789772,18.526892255083364]]]}},{"type":"Feature","properties":{"id":"4","._REGION":" METRO CENTRAL ","._LOCALESCONID":" 3,583 ","._NEGSCONID":" 3,236 ","._CLIENTES":" 972 ","._MONTOCAPTCLIENTES":" 1,156,309,277 ","._NOCLIENTES":" 2,264 ","._MONTOCAPTNOCLIENTES":" 2,186,622,225 ","info":{"region_name":{"label":"Región","value":" METRO CENTRAL "},"clients_count":{"label":"Clientes","value":" 972 "}}},"geometry":{"type":"Polygon","coordinates":[[[-69.92367981802747,18.447106651686255],[-69.94099843010278,18.470946005208802],[-69.94107987228195,18.474995078923442],[-69.94518021427685,18.482623783499402],[-69.94531998623697,18.487618004666768],[-69.94820412271753,18.495210989512337],[-69.94596980482147,18.49950813920476],[-69.94190756879372,18.50244866019303],[-69.94370512585957,18.508344853463562],[-69.9550839308503,18.51643044280942],[-69.9505094256796,18.520208835359252],[-69.94423073099378,18.522505788024663],[-69.91636423352779,18.507192450276364],[-69.91823383516629,18.5017332751713],[-69.91560819640611,18.480299409229396],[-69.90282888998644,18.48086593350876],[-69.89335753755743,18.472750492274123],[-69.89275755836063,18.465007760460306],[-69.92061501812975,18.45295075311598],[-69.92367981802747,18.447106651686255]]]}},{"type":"Feature","properties":{"id":"5","._REGION":" METRO OESTE ","._LOCALESCONID":" 4,400 ","._NEGSCONID":" 4,033 ","._CLIENTES":" 1,352 ","._MONTOCAPTCLIENTES":" 1,259,260,048 ","._NOCLIENTES":" 2,681 ","._MONTOCAPTNOCLIENTES":" 2,263,967,080 ","info":{"region_name":{"label":"Región","value":" METRO OESTE "},"clients_count":{"label":"Clientes","value":" 1,352 "}}},"geometry":{"type":"Polygon","coordinates":[[[-69.9998486194127,18.4259680950038],[-70.00924087148051,18.45929831041422],[-70.01645218819071,18.472290070326864],[-70.0264794253957,18.460703565626375],[-70.036944930724,18.463224779676985],[-70.13582814156875,18.561829916882274],[-70.14448914541917,18.57471731895735],[-70.14833948182017,18.609589730517904],[-70.15555021539431,18.62676654868872],[-70.13676446323404,18.627808476960098],[-70.14551434640292,18.646174814479785],[-70.1558463102757,18.645637295659576],[-70.16107889072732,18.64121891404528],[-70.18385898131069,18.65851257268993],[-70.19907589850409,18.678134014224355],[-70.17369080888017,18.71310578740709],[-70.1758326560461,18.721240015280276],[-70.1672035277601,18.729309789424594],[-70.15515185822194,18.734288466991035],[-70.13658240143643,18.714124459135093],[-70.11520190662134,18.678718818340798],[-70.09357978255646,18.670896213507255],[-70.07149128277514,18.67533922412027],[-70.06502644275686,18.6598689588635],[-70.05385611504204,18.620946108417197],[-70.03314399422545,18.611012420532884],[-70.02377933783987,18.617118928402668],[-70.01126656397228,18.607348277420687],[-70.00431372821167,18.57728524833802],[-69.97802114200083,18.54974282854886],[-69.95926544419666,18.543752622433935],[-69.95207057861019,18.522253363862944],[-69.95779806156062,18.5155569152304],[-69.9468670722399,18.50790555738644],[-69.94707889228211,18.502138243974752],[-69.95120307003549,18.49556542933051],[-69.94374395839093,18.469868217532877],[-69.9255148184119,18.4465990329051],[-69.94459644799747,18.4352772095083],[-69.97545063560122,18.427979093720232],[-69.98241397468384,18.428560492072297],[-69.99343155765523,18.422386203332177],[-69.9998486194127,18.4259680950038]]]}},{"type":"Feature","properties":{"id":"6","._REGION":" SANTIAGO ESTE ","._LOCALESCONID":" 1,653 ","._NEGSCONID":" 1,512 ","._CLIENTES":" 617 ","._MONTOCAPTCLIENTES":" 481,062,654 ","._NOCLIENTES":" 895 ","._MONTOCAPTNOCLIENTES":" 598,663,420 ","info":{"region_name":{"label":"Región","value":" SANTIAGO ESTE "},"clients_count":{"label":"Clientes","value":" 617 "}}},"geometry":{"type":"Polygon","coordinates":[[[-70.59828529178878,19.40118851757625],[-70.65987393171083,19.426449173710644],[-70.70418102932976,19.465314403428657],[-70.72494829358303,19.49729879120749],[-70.81110886058208,19.54407916256621],[-70.8838614545944,19.647199613033244],[-70.83585987336326,19.633875741257445],[-70.81641860463843,19.621816619458475],[-70.81019278941507,19.630069266016243],[-70.77490710614639,19.59674390861978],[-70.75985666180968,19.594580780283607],[-70.74714734273023,19.574756780305307],[-70.73097011945161,19.581499005796793],[-70.7208865430472,19.580363576539323],[-70.69973386981293,19.60272712154908],[-70.70908623206931,19.64733176707379],[-70.67686579965637,19.627869342672675],[-70.6621181616187,19.628184845457778],[-70.6403394098199,19.615325242166787],[-70.64440896619418,19.55698173603693],[-70.63442184520815,19.543087338802952],[-70.57586868097418,19.525932053022903],[-70.55190190228852,19.513525672486306],[-70.55126365293357,19.50086137403423],[-70.58600711595359,19.47768288903408],[-70.59582212560235,19.431285512788854],[-70.59828529178878,19.40118851757625]]]}},{"type":"Feature","properties":{"id":"7","._REGION":" SANTIAGO OESTE ","._LOCALESCONID":" 1,532 ","._NEGSCONID":" 1,417 ","._CLIENTES":" 577 ","._MONTOCAPTCLIENTES":" 351,602,562 ","._NOCLIENTES":" 840 ","._MONTOCAPTNOCLIENTES":" 504,267,024 ","info":{"region_name":{"label":"Región","value":" SANTIAGO OESTE "},"clients_count":{"label":"Clientes","value":" 577 "}}},"geometry":{"type":"Polygon","coordinates":[[[-71.04392962228158,19.04566056615455],[-71.10620012986962,19.068346808507417],[-71.1223917862981,19.083106454762948],[-71.11867410461045,19.103312416897193],[-71.1279486076117,19.122931258363487],[-71.14413426373639,19.127107937230168],[-71.15554437608039,19.14518920945561],[-71.16844890602759,19.148490421088724],[-71.18259532568034,19.15456864895399],[-71.18600934435055,19.165595311353684],[-71.20514972256458,19.181009639256146],[-71.21432938925506,19.180195566957558],[-71.22173377703841,19.21002674610658],[-71.22003608112013,19.22115271068483],[-71.22833339740038,19.240837796602566],[-71.23964433973279,19.248363625237396],[-71.24528052380936,19.2592595263855],[-71.23419590548016,19.270503149428478],[-71.23759647573304,19.289673194202074],[-71.23356133622852,19.29786358880505],[-71.2335310737983,19.312307421701483],[-71.23904957036278,19.325111552674976],[-71.23104778102497,19.336412555754695],[-71.21253376921702,19.334052328480944],[-71.21643212172023,19.355839995448058],[-71.20322897713903,19.372361636010243],[-71.20322897713903,19.372361636010243],[-71.17100747426241,19.379473740640737],[-71.16280367449592,19.37061528598298],[-71.14543212387065,19.369566355416623],[-71.14369061063019,19.37723150845905],[-71.11082938879021,19.389068733141944],[-71.10855506632362,19.403911077784812],[-71.09532715739283,19.40896313656494],[-71.07700795476102,19.407945527425717],[-71.06351496129467,19.422268278096432],[-71.08030875130142,19.429493005606087],[-71.08204837435576,19.45025967039553],[-71.06968861359235,19.460460822476353],[-71.02831431670631,19.438488546418423],[-70.97762257728436,19.438999649632528],[-70.96956753858468,19.45178141814392],[-70.94619017520728,19.440625678902993],[-70.93219566627766,19.436312302553596],[-70.91831122917203,19.444009152851756],[-70.88294291385169,19.440695739788787],[-70.8636155183504,19.45651550081119],[-70.89129913202657,19.471451125017754],[-70.90209537453941,19.492763855677058],[-70.884136941854,19.53315106053992],[-70.9200851011672,19.55737576713434],[-70.92833949753442,19.579457558419875],[-70.89473278524032,19.563362792250974],[-70.88167856095465,19.576003043942556],[-70.87600706196127,19.62098674491379],[-70.81161933761594,19.539968291377708],[-70.72707782485594,19.495034083437876],[-70.70577301599627,19.460281939559515],[-70.6623646059522,19.422736245137198],[-70.59919477001431,19.393465090424392],[-70.63607730148827,19.373660971175497],[-70.6750782064091,19.331535772156336],[-70.67503462568489,19.29342547840923],[-70.71750768710318,19.297340480674965],[-70.72027989524912,19.27630686779074],[-70.68096618572034,19.26114382179523],[-70.67671260541677,19.193644510663034],[-70.72638646201221,19.209267311103744],[-70.73739657889956,19.196605976118825],[-70.73243685041467,19.191107902823042],[-70.74249863522459,19.166431873423544],[-70.75488296403118,19.15804007170014],[-70.76984515135925,19.14937748850666],[-70.7889414187785,19.140801715125512],[-70.81317346706027,19.140868866117355],[-70.81927376256894,19.124372637636426],[-70.86172238026562,19.098242171087115],[-70.93579996858982,19.09991985388453],[-70.94822752067384,19.098089074102415],[-70.95560749041432,19.077472814577995],[-70.96195667008237,19.045489287195842],[-70.97546146190312,19.039611325680262],[-70.99830110462543,19.043148370523085],[-71.01062420480098,19.02912533734235],[-71.02783772853212,19.021976346965108],[-71.03926940121252,19.02651379408817],[-71.04392962228158,19.04566056615455]]]}},{"type":"Feature","properties":{"id":"8","._REGION":" NORCENTRAL ","._LOCALESCONID":" 1,632 ","._NEGSCONID":" 1,534 ","._CLIENTES":" 808 ","._MONTOCAPTCLIENTES":" 547,043,178 ","._NOCLIENTES":" 726 ","._MONTOCAPTNOCLIENTES":" 550,611,214 ","info":{"region_name":{"label":"Región","value":" NORCENTRAL "},"clients_count":{"label":"Clientes","value":" 808 "}}},"geometry":{"type":"Polygon","coordinates":[[[-70.81928850058421,18.852976062012242],[-70.82991241704217,18.88277184533608],[-70.82580812021708,18.913360756944076],[-70.84091896310797,19.002824471137558],[-70.88719707390632,19.005706336094562],[-70.95378153112986,19.053842991651848],[-70.93606823418064,19.093082083882784],[-70.85787178543642,19.093853850547166],[-70.80730157962418,19.125524864804756],[-70.74720841397,19.145301890760315],[-70.7228865569977,19.196648645583437],[-70.6703233182379,19.19046373710088],[-70.67349229177945,19.26269169828899],[-70.70781860178106,19.28452656478586],[-70.66750389844444,19.287895444492484],[-70.6647972536675,19.333101725916407],[-70.60499866736649,19.377393301467194],[-70.57685775985986,19.38760666351639],[-70.57827677082788,19.43892849678596],[-70.48042646933983,19.437722544431498],[-70.44077007321955,19.387982890166327],[-70.37302699603971,19.240996464407743],[-70.34137507085917,19.192404724016725],[-70.29633099630544,19.15029058693013],[-70.32988826732281,19.148874949386506],[-70.33695618304371,19.138597289907082],[-70.33568324722725,19.11931909106787],[-70.3686015148514,19.047453392147496],[-70.37180890037176,19.01895931866026],[-70.35201107130649,18.984702264902428],[-70.34191888163019,18.986839840469855],[-70.33687261020674,18.967002860577583],[-70.23756449910317,18.883784871342176],[-70.22907717700731,18.86011039713252],[-70.24894148052884,18.83999929985208],[-70.25049321118678,18.813838229887644],[-70.29845168072552,18.789808537019198],[-70.30351110676227,18.764227621539785],[-70.31725652011066,18.724685070475946],[-70.36034806537565,18.734877845813024],[-70.406378100093,18.760883657905175],[-70.43395294122443,18.762001092476854],[-70.48601469258186,18.777552272375658],[-70.54057012609199,18.8053403265858],[-70.54619040813193,18.757323738576684],[-70.56406548823335,18.73831547158847],[-70.58247596835109,18.731655870052613],[-70.59760540920243,18.713491145250583],[-70.60222491517257,18.69153398284759],[-70.6449815905714,18.6975804524511],[-70.68085488179791,18.69541325812191],[-70.67837927023302,18.748228034792284],[-70.69597256637506,18.772358717016562],[-70.7341652785543,18.780225997368838],[-70.81928850058421,18.852976062012242]]]}},{"type":"Feature","properties":{"id":"9","._REGION":" NORDESTE ","._LOCALESCONID":" 1,710 ","._NEGSCONID":" 1,619 ","._CLIENTES":" 985 ","._MONTOCAPTCLIENTES":" 617,189,325 ","._NOCLIENTES":" 634 ","._MONTOCAPTNOCLIENTES":" 251,639,443 ","info":{"region_name":{"label":"Región","value":" NORDESTE "},"clients_count":{"label":"Clientes","value":" 985 "}}},"geometry":{"type":"Polygon","coordinates":[[[-70.22176130643363,18.88137776251288],[-70.32831780151105,18.967294553520304],[-70.33162834664039,18.993545303988004],[-70.35029423278696,18.99844232671996],[-70.36770995693732,19.02019173019643],[-70.35439955003953,19.075412921286564],[-70.32896506801191,19.114070852254493],[-70.33103402076173,19.13019289170858],[-70.32593329822583,19.145226949199586],[-70.289682769876,19.147138853228242],[-70.2849920427555,19.154964595252462],[-70.33866544236305,19.19681565484102],[-70.37161008668765,19.25089909933792],[-70.37329429596012,19.282368802671126],[-70.43933083985394,19.392940549736192],[-70.47814438340643,19.442412360960194],[-70.57986262771463,19.44795090925272],[-70.57844894065887,19.473894241421604],[-70.54354988186849,19.49732239339653],[-70.54265341007203,19.512314742116494],[-70.5227060303664,19.53206957715855],[-70.51684903084849,19.552691169685875],[-70.50891760896742,19.565732701910413],[-70.49300498978498,19.603744038330554],[-70.46671594102672,19.614005474682962],[-70.44957990585122,19.628027143018407],[-70.45186715520184,19.652117137532922],[-70.41697285052392,19.65140534076433],[-70.4065983945658,19.659998973903555],[-70.39405612311023,19.664256908962347],[-70.36273043138544,19.69087626128796],[-70.32370205192316,19.66241946365276],[-70.27103093115538,19.640115994994098],[-70.2400392777758,19.638935429711932],[-70.1813116060211,19.6237924079416],[-70.1675656013195,19.617021410851816],[-70.1599666342605,19.61594557632404],[-70.09444181645114,19.625305747766806],[-70.05654532032548,19.671627168001343],[-69.97706629454953,19.67663061574366],[-69.94662019712038,19.669432035243158],[-69.93167226560149,19.64975052749048],[-69.92109381597535,19.65004831320915],[-69.90051554959578,19.639481904497945],[-69.88671336559568,19.605940658310818],[-69.89969177300621,19.583483234644817],[-69.9008318090364,19.561849172942242],[-69.91013520950607,19.55059144784402],[-69.89794451053899,19.52642013629408],[-69.87294289622992,19.5076856432042],[-69.88032824242472,19.456284339022897],[-69.84959275257292,19.391362692277404],[-69.85162377243135,19.3734501619667],[-69.8217613445492,19.349469466524617],[-69.78511548120798,19.299175041134028],[-69.72294237622658,19.26962202794941],[-69.58338590510861,19.296104960838402],[-69.54238107198847,19.315372296089365],[-69.5060038767326,19.319777015434603],[-69.4448745664137,19.31557009376634],[-69.33971708002564,19.279612610600676],[-69.3223065318295,19.282187836614675],[-69.31516838910659,19.30308237346769],[-69.22930787042527,19.3528081722626],[-69.25684223396232,19.29595300489071],[-69.23868613441907,19.28158677007268],[-69.1629776428518,19.292656590962444],[-69.1640084103627,19.2713896437352],[-69.21425148360996,19.231635804425004],[-69.23051376654712,19.184657572862776],[-69.31788960261373,19.2100607204088],[-69.41597358206407,19.19672121517282],[-69.47901546616298,19.212780679275962],[-69.55259323510225,19.215641640448453],[-69.62433007823226,19.22967734509247],[-69.64509661939375,19.127306023250316],[-69.62762905725143,19.075930496074538],[-69.60865086441522,19.07560787356253],[-69.62312317290066,18.990594807461765],[-69.69193687355761,19.047894171048217],[-69.7179625732355,19.092112839296522],[-69.74079223774,19.099745599477924],[-69.78384461764247,19.09802664251179],[-69.80046242491728,19.08231410214542],[-69.86122079566003,19.08979898847175],[-69.87730880883718,19.082403272071065],[-69.8729321195717,19.049977086196424],[-69.92559901758341,19.040388246175024],[-69.93872432328416,18.994496865975062],[-69.92679106206332,18.975893563268468],[-69.95070302482013,18.90376473885791],[-69.97417363320162,18.889153163565283],[-69.99020285297561,18.88844520856586],[-70.01573143239303,18.91420852914269],[-70.03696246467989,18.908607847404543],[-70.04182229052813,18.890810043434893],[-70.05436675618726,18.890097934797456],[-70.08768586508543,18.899046282750028],[-70.13919304537708,18.863718228578072],[-70.20088570614956,18.871918398378835],[-70.222183501668,18.85921936146358],[-70.22176130643363,18.88137776251288]]]}},{"type":"Feature","properties":{"id":"10","._REGION":" ESTE ","._LOCALESCONID":" 1,664 ","._NEGSCONID":" 1,547 ","._CLIENTES":" 679 ","._MONTOCAPTCLIENTES":" 496,866,933 ","._NOCLIENTES":" 868 ","._MONTOCAPTNOCLIENTES":" 786,581,515 ","info":{"region_name":{"label":"Región","value":" ESTE "},"clients_count":{"label":"Clientes","value":" 679 "}}},"geometry":{"type":"Polygon","coordinates":[[[-69.50736616030689,18.406120581931205],[-69.52746585628311,18.404835128395824],[-69.52636532488478,18.436285598223215],[-69.52674342936298,18.44656434470073],[-69.52428193637459,18.449758958968122],[-69.517799867983,18.453406693403505],[-69.51633600411796,18.47036074653465],[-69.53968010616488,18.470372392431354],[-69.56582148684436,18.475411898875116],[-69.59520019567138,18.49096441851478],[-69.60302305286191,18.511720514453028],[-69.61807046568819,18.52052396940017],[-69.60624360626974,18.53499138667795],[-69.57475641659205,18.582921532760313],[-69.59048687027432,18.590692603206598],[-69.5788413180432,18.612353787976296],[-69.58215783735773,18.61676956256349],[-69.59424574753278,18.61185776710931],[-69.59494632295825,18.625211848092178],[-69.57712691060708,18.65076036544927],[-69.55255397226837,18.667881057779383],[-69.53321216627249,18.739955530005286],[-69.50670588635623,18.764674962180294],[-69.49158926502399,18.772011132777184],[-69.48692740505396,18.792163232959577],[-69.44304185101115,18.816272454434337],[-69.42975603690812,18.83642958987922],[-69.37436551052923,18.868462918238638],[-69.36605136541422,18.891168231945304],[-69.43139702813066,18.884356809393932],[-69.58559788879084,18.992887216824716],[-69.61856811180202,18.994723731606367],[-69.59743872898335,19.079407334754787],[-69.5038937062869,19.079232487319995],[-69.45677606576706,19.067738757361937],[-69.43752776375156,19.072099140800827],[-69.43095838474444,19.095072586769756],[-69.40934864538823,19.095274456122173],[-69.37790420096957,19.051554368001],[-69.34335343699121,19.041838638873365],[-69.31410203738909,19.04394012034454],[-69.26437508319445,19.011802561774672],[-69.22526084511946,19.0203089739164],[-69.20164089695362,19.005174529224938],[-69.16290236308599,19.0042343988413],[-69.1416083910358,18.99017636788406],[-69.12559495418014,19.012803709364306],[-69.0759676029457,18.981801532279757],[-68.997843504913,18.98582220210624],[-69.00226077239233,19.0117960305448],[-68.98232351615925,19.009782800531557],[-68.96957516410241,19.02412431413239],[-68.92134644391865,19.025174146358452],[-68.87090535231698,18.990015373987024],[-68.85466562892906,18.989975402467408],[-68.83991620604152,18.991600899595575],[-68.81620028269766,18.97912675049097],[-68.80417112395473,18.979672567560023],[-68.77959535964112,18.97044647026872],[-68.71553182086474,18.933619158984694],[-68.64002054103064,18.861241902056214],[-68.56639162265624,18.789582056153126],[-68.53263325874272,18.770613880959726],[-68.52540501998713,18.7733356255062],[-68.48392217741363,18.735150943045902],[-68.46165746974194,18.727402271938733],[-68.44248511759302,18.703028065077962],[-68.41739415397116,18.68198265406328],[-68.39464633239193,18.658697935974075],[-68.37413860394183,18.656409899594518],[-68.332941712729,18.620776242603295],[-68.33550346675594,18.603201888484847],[-68.33257463422024,18.58420802036415],[-68.34789722742475,18.55435280528049],[-68.38481077040404,18.50317377465565],[-68.3950178268102,18.497298028988325],[-68.40957917272534,18.463928058086402],[-68.44290472637124,18.435215087329475],[-68.45480173327931,18.411938001884586],[-68.45578323576845,18.363946659072756],[-68.46458486541613,18.34739276865784],[-68.48970343573377,18.3402752331492],[-68.57549005044102,18.37443104033902],[-68.60030985433883,18.386695470318354],[-68.6128118090136,18.37514860867505],[-68.62351047205094,18.354943281456308],[-68.61148418818269,18.344949037281197],[-68.60636131521326,18.33004693305758],[-68.62698172121242,18.301137548881602],[-68.64406621742572,18.252545695400823],[-68.65059401374269,18.223453397339966],[-68.69966114203,18.21513612603937],[-68.74880222105153,18.22891406155913],[-68.81481288890436,18.34518129924214],[-68.83132398428393,18.353708680391904],[-68.84349197316934,18.380076979119202],[-68.90530615928172,18.40783700898332],[-68.93516065551509,18.412025160358727],[-68.95960792151128,18.421472479472175],[-69.0322539213439,18.396963005880416],[-69.07127191729187,18.39414108265047],[-69.09624998613471,18.398332041239357],[-69.12122980015552,18.40787804431563],[-69.1386895271104,18.407554398273813],[-69.18861038819519,18.427787592699598],[-69.19785563459793,18.4528361315286],[-69.21489503484844,18.453152322342593],[-69.29080119427044,18.43851640928763],[-69.31815213749162,18.451607445103033],[-69.32487143405494,18.430747794414586],[-69.33646188016496,18.42771200940127],[-69.3555423038456,18.42590686218057],[-69.40143887569575,18.42893799976301],[-69.44468315281786,18.425098600517035],[-69.50736616030689,18.406120581931205]]]}},{"type":"Feature","properties":{"id":"11","._REGION":" SUR ESTE ","._LOCALESCONID":" 1,210 ","._NEGSCONID":" 1,134 ","._CLIENTES":" 569 ","._MONTOCAPTCLIENTES":" 298,814,187 ","._NOCLIENTES":" 565 ","._MONTOCAPTNOCLIENTES":" 152,036,125 ","info":{"region_name":{"label":"Región","value":" SUR ESTE "},"clients_count":{"label":"Clientes","value":" 569 "}}},"geometry":{"type":"Polygon","coordinates":[[[-70.81110319655474,18.37505235223323],[-70.83102665798054,18.518297123211756],[-70.79688648594754,18.575211522992525],[-70.8063151913261,18.670202896012924],[-70.79837213019043,18.726838499584083],[-70.82770725275832,18.81165574810284],[-70.80564632720176,18.830165949221],[-70.74829298088989,18.77090893263572],[-70.71150794677347,18.75852300212115],[-70.6902679912914,18.7389817160091],[-70.69928860801137,18.681042224002198],[-70.6441949632216,18.686028877823755],[-70.60079987190952,18.679624335868212],[-70.58221496835378,18.707300304491515],[-70.5757380921375,18.72511770747464],[-70.53750632791997,18.740321870294135],[-70.53796092899724,18.79876766499991],[-70.49067793550614,18.77202845696587],[-70.4358742161095,18.75247590249559],[-70.40320297291555,18.75218226916273],[-70.37236240956372,18.731184825578428],[-70.3154731211978,18.71883469305092],[-70.2913920398765,18.7848748254183],[-70.24851891077854,18.806790183366132],[-70.22202462560232,18.767405204551963],[-70.1870354846587,18.747539229183996],[-70.18352519663907,18.71607997257755],[-70.20632729861362,18.6706700858828],[-70.16881025455737,18.630639276947953],[-70.14960925403214,18.56955455387737],[-70.07239079899456,18.485961131068027],[-70.01076235811865,18.440633117306625],[-70.07716069344882,18.3398383675348],[-70.16929973352542,18.23201045672817],[-70.20468894679647,18.2384315955839],[-70.23093153394392,18.23069032783476],[-70.26536936511248,18.242015785576765],[-70.29170950961615,18.243938134381576],[-70.3383990418645,18.23274204456816],[-70.41892536746164,18.24195771620017],[-70.4367980603535,18.218727672635502],[-70.50035925269735,18.201182329624793],[-70.52875201400961,18.244679643647185],[-70.56436148332634,18.254967123476835],[-70.58050380074685,18.290394894735414],[-70.55829321723569,18.367432524540245],[-70.589192543943,18.417958283876377],[-70.65284552041327,18.437290468761642],[-70.7021178638365,18.428551523385483],[-70.7185311677901,18.368375336920472],[-70.76163902722809,18.35618175388095],[-70.81110319655474,18.37505235223323]]]}},{"type":"Feature","properties":{"id":"12","._REGION":" NOROESTE ","._LOCALESCONID":" 1,339 ","._NEGSCONID":" 1,256 ","._CLIENTES":" 677 ","._MONTOCAPTCLIENTES":" 336,917,161 ","._NOCLIENTES":" 579 ","._MONTOCAPTNOCLIENTES":" 221,287,657 ","info":{"region_name":{"label":"Región","value":" NOROESTE "},"clients_count":{"label":"Clientes","value":" 677 "}}},"geometry":{"type":"Polygon","coordinates":[[[-71.6496421204616,19.24627516330094],[-71.68512682320485,19.25173257137287],[-71.7678455685452,19.33055344460396],[-71.71737913427889,19.36653860156364],[-71.68579540955666,19.3544995085463],[-71.68552065651207,19.39760300799975],[-71.66664364576935,19.44770300843856],[-71.68387985153268,19.485222451478908],[-71.67441303833905,19.50527191111622],[-71.68754376368685,19.531538803103462],[-71.69993391126962,19.545011927107275],[-71.73321840379016,19.592038412637525],[-71.73758156654087,19.632860031491063],[-71.72579363563793,19.659377476873733],[-71.7467001206,19.692440758321563],[-71.72533447059537,19.699097132838602],[-71.71787522792899,19.739989048923174],[-71.74239047857708,19.802836065173693],[-71.69229990843421,19.820016422234563],[-71.64054733820666,19.878722541144555],[-71.48468120590613,19.90461367286262],[-71.39761250753463,19.858420443657543],[-71.34273411765936,19.841924716236626],[-71.2967694940592,19.839366404507892],[-71.25726321226267,19.819181137054994],[-71.21463265998118,19.833584336414923],[-71.20571552723769,19.861139275702957],[-71.17440016832622,19.845362854990636],[-71.12048615054039,19.85366034071035],[-71.07133711776622,19.878992198886543],[-71.07778985043954,19.89761841807594],[-71.05055825661051,19.91801584128425],[-70.98105788382627,19.92802722293595],[-70.96331367116885,19.908419209660746],[-70.95665539979332,19.89381646232779],[-70.93297262827632,19.891558590558578],[-70.8494434665923,19.8984368360471],[-70.80954743624797,19.873666737233695],[-70.78548663561425,19.844502248075123],[-70.78652281639563,19.826615748201483],[-70.74880243719016,19.832412872097883],[-70.70773271661719,19.804623305721886],[-70.6481004719607,19.76714266658966],[-70.63032500521689,19.756411784841838],[-70.62005274487639,19.764170627146523],[-70.59053052631609,19.751181637172145],[-70.56210997679631,19.759240855362844],[-70.55186333631144,19.753508236726365],[-70.52047882276838,19.74898667042928],[-70.50752781629821,19.77565165709486],[-70.45660786602076,19.781014216165985],[-70.41905408291291,19.749350764932007],[-70.39994290606312,19.747506548459178],[-70.36353226293843,19.696651729936267],[-70.40993579216489,19.665934869765042],[-70.4201456375688,19.655398333656223],[-70.4459747905615,19.661923295301648],[-70.46140981786573,19.655473495339116],[-70.45540571344878,19.625838585993478],[-70.5021779236647,19.60375725503467],[-70.52557225152903,19.552612089941064],[-70.52976427579128,19.534491125050483],[-70.54635851772362,19.517027301919896],[-70.63123233242689,19.546011315323966],[-70.63869866446147,19.557631617318606],[-70.63558035036247,19.620710853633803],[-70.66114675343951,19.634653964966972],[-70.67694705929374,19.6310425637266],[-70.7115539757201,19.650896027437696],[-70.704402771097,19.606337641971127],[-70.72067098484028,19.58917884493102],[-70.74463503430762,19.58090652173435],[-70.75836440864272,19.599558165769604],[-70.77271662432774,19.599097131188778],[-70.81023100712639,19.6339190498655],[-70.8187769675001,19.62996584977676],[-70.88321459934198,19.65336853668561],[-70.88917833405138,19.640969768984103],[-70.88039261919765,19.627713470295173],[-70.88350399845744,19.596432647278235],[-70.8947751933003,19.56880868654199],[-70.94087404685608,19.58960228256346],[-70.934965816615,19.556167143858705],[-70.88828417210175,19.53112086670173],[-70.90910208944358,19.493062467759334],[-70.90346215016999,19.47148801442514],[-70.87038178714903,19.45742542170109],[-70.88603731615935,19.44639631942127],[-70.92161439335838,19.447954946210658],[-70.93287247957913,19.43983265251683],[-70.96923822768404,19.45760739715038],[-70.98169179734734,19.441515258451336],[-71.02826638731332,19.441923703142],[-71.07300448492511,19.46597884831482],[-71.09044102929315,19.44881447394415],[-71.0884623044195,19.426322852536344],[-71.07869538416091,19.413825700357616],[-71.11211754784087,19.409278469087294],[-71.115814813917,19.395646450842378],[-71.13049517048243,19.391687912642663],[-71.15040097872301,19.381633536684504],[-71.16718020275623,19.391527539172614],[-71.19371884624687,19.38724033494666],[-71.21763133509512,19.37093974577981],[-71.2500745225788,19.329430791754184],[-71.24844848313,19.291409694966397],[-71.25759872160167,19.261497215880265],[-71.23437661896757,19.227776465177545],[-71.22380409730347,19.182561857921954],[-71.26129722572747,19.180052885877434],[-71.30574344839337,19.184415458712476],[-71.43520305853403,19.24961175311331],[-71.49193297842251,19.26255464165288],[-71.50195087240189,19.285001886379],[-71.51981572262028,19.28475384844852],[-71.55707315291248,19.285562560774046],[-71.58927636624044,19.29854320325866],[-71.60331830394684,19.264470212954915],[-71.6496421204616,19.24627516330094]]]}}];
			
			//Getting the map
			var regions_data = [
				{name: 'METROPOLITANA CENTRAL', color: '#ce93d8', value: 10, center_coords: {lat:18.472467, long:-69.925593}, zoom: 13},
				{name: 'METROPOLITANA OESTE', color: '#007688', value: 20, center_coords: {lat: 18.594692, long: -70.033461}, zoom: 11},
				{name: 'METROPOLITANA NORTE', color: '#004688', value: 20, center_coords: {lat:18.855471, long:-69.750748}, zoom: 10},
				{name: 'METROPOLITANA ORIENTAL', color: '#FF5A5E', value: 40, center_coords: {lat:18.526996, long:-69.742857}, zoom: 11},
				{name: 'ZONA ESTE', color: '#edaf30', value: 50, center_coords: {lat:18.838941, long:-68.794927}, zoom: 9},
				{name: 'ZONA SANTIAGO ESTE', color: '#80cbc4', value: 80, center_coords: {lat:19.538509, long:-70.726169}, zoom: 11},
				{name: 'ZONA SANTIAGO OESTE', color: '#cd23d8', value: 10, center_coords: {lat: 19.290608, long: -70.921437}, zoom: 10},
				{name: 'ZONA NORCENTRAL', color: '#009688', value: 45, center_coords: {lat:18.987126, long:-70.527144}, zoom: 9},
				{name: 'ZONA NORDESTE', color: '#7986cb', value: 40, center_coords: {lat:19.411188, long:-70.038893}, zoom: 9},
				{name: 'ZONA NOROESTE', color: '#4caf50', value: 50, center_coords: {lat:19.673018, long:-71.119545}, zoom: 9},
				{name: 'ZONA SURESTE', color: '#90caf9', value: 80, center_coords: {lat: 18.564102, long: -70.500380}, zoom: 10},
			];

			//Showing the map
			var map_view = new MapView(scope);			
			
			//Building map regions
			var object_name = 'polar-chart-country';
			var regions_char_object = document.getElementById(object_name).getContext("2d");		

			var regions_chart_structure = {names: [], colors: [], values: []};
			for (var i = 0; i < regions_data.length; i++) {
				var record = regions_data[i];
				regions_chart_structure.names.push(record.name);
				regions_chart_structure.colors.push(record.color);
				regions_chart_structure.values.push(record.value);
			};

		    var config = {
		        data: {
		            datasets: [{
		                data: regions_chart_structure.values,
		                backgroundColor: regions_chart_structure.colors,
		            }],
		            labels: regions_chart_structure.names          
		        },
		        options: {
		            responsive: true,
		             type: 'pie',
		            legend: {
		                position: 'left',
		            },
		            scale: {
		              ticks: {
		                beginAtZero: false
		              },
		              reverse: false
		            },
		            animation: {
		                animateRotate: true,
		                animateScale: true
		            },
		            onClick:function(evt, elem){
		            	var region_name = elem[0] ? elem[0]._model.label : (elem ? elem.text : null);
		            	if(region_name){
		            		var region = (regions_data.filter(function(e){ if(e.name == region_name) return e}))[0];
		            		map_view.hidePopup();
		            		map_view.showRegion(region);            		
		            	}
		            }
		        }
		    };

		    scope.region_chart = Chart.PolarArea(regions_char_object, config);			
		}

		http.get('/dashboard/office_risk/' + scope.indicator_type, {indicator_type : scope.indicator_type})
		.then(function (res) {
			load_map(res.data);
		})
		.catch(function (error) {
			console.log('Error trying to load map data');
		});

	}]);

})()
